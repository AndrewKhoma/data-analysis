\input{univ.sty}

\lhead{Лекції з аналізу даних, 2018}

\begin{document}

Під час аналізу даних виділяються наступні етапи: отримання вхідної інформації, безпосередньо сама обробка її, аналіз та інтерпретація результатів обробки даних. \\

Головне зробити правильні висновки з результатів. \\

Значення змінних які спостерігаються можуть бути як \textit{кількісні} так і \textit{якісні}. Якісні змінні поділяють на \textit{ординальні} та \textit{номінальні}. Ординальні змінні називають \textit{порядковими}, а номінальні -- \textit{класифікаційними}. Обидва типи змінних приймають свої значення з деякої множини, елементи якої називають \textit{градаціями}. Градації, які приймає як свої значення ординальна змінна, природно \textbf{впорядковані за степенем прояву властивості}. Градації номінальної змінної такого порядку \textbf{не мають}. Серед якісних змінних виділяють \textit{категоризовані} та \textit{не категоризовані}. \\

До категоризованих змінних відносять змінні, для яких повністю визначена множина градацій та правило віднесення значення змінної, яке спостерігається, до певної градації. \\

Змінні ще поділяють на \textit{дискретні} та \textit{неперервні}.

\section{Групування даних}

$\xi$ -- скалярна змінна, яка досліджується. \\

Вибірка об'єму $n$: $x_1, x_2, \ldots, x_n$. \\

У випадку великих об'ємів вибірок виникає бажання провести деяке перетворення їх з метою стиснення даних без суттєвої втрати вибірками інформативності, а тільки згодом проводити обробку цих перетворених даних. Як правило, його застосовують при обробці спостережень над неперервними змінними, коли об'єм вибірки перевищує 50, а над дискретними змінними, коли кількість значень $m$, які вони приймають, перевищує 10. \\

Перехід до згрупованих даних:
\begin{enumerate}
    \item Визначити $x_{\min} = \Min_i (x_i)$, $x_{\max} = \Max_i (x_i)$;
    
    \item Інтервал $[x_{\min}, x_{\max}]$ розбивають на $s$ однакових під-інтервалів $[a_i, b_i)$, $i = \overline{1,s}$. Зазвичай $5 \le s \le 30$. Зазвичай $s = 1 + [\log_2 n]$ або $s = [10 \log_{10} (n)]$;
    
    \item $x_i^* = \dfrac{a_i + b_I}{2}$ -- центральна точка. \\
    
    $v_i$ -- кількість вимірів з вибірки що належать інтервалу $[a_i, b_i)$. \\
    
    $\{x_1, x_2, \ldots, x_n\} \mapsto \{x_i^*, v_i\}_{i=1}^s$ $\left( \Sum_{i=1}^s v_i = n \right)$. \\
    
    Рекомендується $v_i \ge 5$, в разі $v_i < 5$ сусідні інтервали зливаються в один.
\end{enumerate}

\textbf{Зауваження!} При проведенні групування даних зовсім не обов'язково брати під-інтервали однакової довжини. \\

$F_\xi (x) = P\{ \xi < x\}$ -- функція розподілу, $p_\xi(x)$ -- функція щільності, $\{ y_i, p_i \}_{i=1}^m$ -- полігон ймовірності, якщо $\xi$ -- дискретна випадкова величина, що набуває значення $y_i$ з ймовірністю $p_i$, $i=\overline{1,m}$. \\

Оцінка характеристик по згрупованим даним:

Емпірична (вибіркова) функція розподілу $\hat{F}_\xi (x)$ буде $\hat{F}_\xi (x) = \dfrac{1}{n} \Sum_{i: b_i \le x} v_i$. \\

Емпірична (вибіркова) функція щільності $\hat{p}_\xi (x)$ буде $\hat{p}_\xi (x) = \dfrac{v_{i(x)}}{n (b_{i(x)} - a_{i(x)}}$, де $i(x)$ -- номер під-інтервалу якому належить $x$.

\section{Моделювання змінних}

Потреба в генерації спостережень над випадковими величинами із заданими функціями розподілу. \\

Зазвичай $\xi = g(\xi_1, \xi_2, \ldots, \xi_q)$, де $\xi_1, \xi_2, \ldots, \xi_q$ -- найпростіші випадкові величини, як правило вони рівномірно розподілені на відрізку $[0, 1)$. \\

Датчик (генератор) випадкових чисел -- спеціальний пристрій, який після запиту на виході дозволяє отримати реалізацію випадкової величини із заданим законом розподілу. \\

Класи датчиків (генераторів) випадкових чисел:
\begin{itemize}
    \item \textbf{табличні} -- таблиця, заповнена реалізаціями випадковою величини із заданим законом розподілу, зазвичай досить високої якості, але вони маю обмежений об'єм. Кількість вибірок невелика. 
    
    \item \textbf{фізичні} -- деякий електронний пристрій на виході якого отримують необхідну реалізацію вибірки довільного об'єму, але кожна вибірка унікальна і неповторна.
    
    \item \textbf{програмні} -- програма, що формує потрібну реалізацію. Базуються на використанні рекурентних формул з деякою глибиною пам'яті: задаючи однакові початкові значення можна отримати однакові вибірки. Генератор періодичний, отримані числа ``псевдовипадкові''.
\end{itemize}

\section{Програмні датчики}

Генератор випадкової величини з $F(x) = U([0, 1))$. \\

\textbf{Лінійна змішана формула}:
\begin{system*}
    x_i &= \dfrac{\tilde{x}_i}{M} \\
    \tilde{x}_i &= \left( a_0 + \Sum_{j=1}^\ell a_j \tilde{x}_{i-j} \right)\text{ mod }M, i = 1, 2, \ldots
\end{system*}
$\ell \ge 1$, $a_j \ge 0$ ($j = \overline{1, \ell}$), $M > 0$, $\ell$, $a_j$ ($j = \overline{0, \ell}$), $M \in \ZZ^+$, $0 \le \tilde{x}_{\ell - j} \le M - 1$, $j = \overline{1,\ell}$. \\

\textbf{Мультиплікативний конгруентний метод}:
Лінійна змішана формула ($\ell = 1$, $a_0 = 0$).
\begin{system*}
    x_i &= \dfrac{\tilde{x}_i}{M} \\
    \tilde{x}_i &= (a_1 \tilde{x}_{i-1})\text{ mod }M, i = 1, 2, \ldots
\end{system*}
$0 \le \tilde{x}_0 \le M - 1$, $\{\tilde{x}_i\}_{i \ge 0} \in \{0, 1, \ldots, M - 1\}$. \\

Послідовність $\{\tilde{x}_i\}_{i \ge 0}$ періодична. $T_{\max}$ -- максимальний період. $T_{\max} \le M$. Вигідно взяти $M$ якомога більшим, ближчим до максимального цілого числа, наприклад найбільше просте число, що менше $\Max \text{int}$. \\

Мультиплікативний конгруентний метод не дозволяє досягти максимального теоретично можливого періоду рівного $M$.

\[ \lambda(M) = \begin{cases} 1, & M = 2 \\ 2, & M = 4 \\ p^{q - 1}(p - 1), & M = p^q, p > 2, p \in \PP, q \ge 1 \\ \text{lcm}\left(\lambda\left(p_1^{q_1}\right), \lambda(p_2^{q_2}), \ldots, \lambda(p_k^{q_k})\right), & M = p_1^{q_1} \cdot p_2^{q_2} \cdot \ldots \cdot p_k^{q_k}. \end{cases} \]

\begin{theorem}
    Максимальний період послідовність $\{\tilde{x}_i\}_{i \ge 0}$ мультиплікативного конгруентного методу $T_{\max} = \lambda(M)$. $T_{\max}$ досягається при:
    \begin{enumerate}
        \item $\text{gcd}(\tilde{x}_0, M) = 1$;
        
        \item $a_1^{\lambda(M)}\text{ mod }M = 1$, $a_1$ є первісним коренем за модулем $M$.
    \end{enumerate}
\end{theorem}

\textbf{Зауваження}. Якщо покласти $M$ рівним простому числу, то $T_{\max} = M - 1$. В залежності від розрядності комп'ютера найбільшим простим числом буде:
\begin{table}[H]
    \centering
    \begin{tabular}{cccc}
        розрядність & 16 & 32 & 64 \\
         $\max$ просте число & $2^{16} - 15$ & $2^{32} - 5$ & $2^{64} - 59$  
    \end{tabular}
\end{table}

\textbf{Змішаний конгруентний метод}: \\

Лінійна змішана формула ($\ell = 1$, $a_0 > 0$).
\begin{system*}
    x_i &= \dfrac{\tilde{x}_i}{M} \\
    \tilde{x}_i &= (a_0 + a_1 \tilde{x}_{i-1})\text{ mod }M, i = 1, 2, \ldots
\end{system*}

\begin{theorem}
    Для отримання послідовності $\{\tilde{x}_i\}_{i\ge0}$ яка досягає свого $\max$ періоду $T_{\max} = M$, необхідно:
    \begin{itemize}
        \item $\text{gcd}(a_0, M) = 1$;
        
        \item $(a_1 - 1)\text{ mod }p = 0$ для всіх $p|M$, $p \in \PP$;
        
        \item $(a_1 - 1)\text{ mod }4 = 0$, якщо $4|M$.
    \end{itemize}
\end{theorem}

\textbf{Зауваження!} Вибір параметрів змішаного конгруентного методу не є гарантією високої якості вибірки. Наприклад $a_0 = a_1 = 1$. \\

\textbf{Квадратичний конгруентний метод}:
\begin{system*}
    x_i &= \dfrac{\tilde{x}_i}{M} \\
    \tilde{x}_i &= (a_0 + a_1 \tilde{x}_{i-1} + a_2 \tilde{x}_{i-1}^2)\text{ mod }M, i = 1, 2, \ldots
\end{system*}
$T_{\max} = M$. \\

\textbf{Ускладнення лінійної змішаної формули}:
\begin{system*}
    x_i &= \dfrac{\tilde{x}_i}{M} \\
    \tilde{x}_i &= g(\tilde{x}_{i-1}, \tilde{x}_{i-2}, \ldots, \tilde{x}_{i-\ell})\text{ mod }M, i = 1, 2, \ldots
\end{system*}
$T_{\max} = M$.

\section{Моделювання дискретних випадкових величин}

Скористаємося побудованими датчиками для $U([0,1))$. \\

$\xi$ -- дискретна випадкова величина $p_i = P\{ \xi = y_i \}$, $i = \overline{1,m}$. \\

$\Sum_{i=1}^m p_i = 1$, отже інтервал $[0, 1)$ можна розбити на $m$ під-інтервалів 
\[ \delta_1 = [0, p_1), \Delta_2 = [p_1, p_1 + p_2), \ldots, \Delta_i = \left[\Sum_{j=1}^{i-1} p_j, \Sum_{j=1}^i p_j \right), \ldots, \Delta_m = \left[ \Sum_{j=1}^{m-1} p_j, 1 \right) \] 

Довжина інтервалу $\Delta_i$ дорівнює $p_I$ ($i = \overline{1,m}$). \\

Отримуємо від датчика $U([0,1))$ значення $X$. Якщо $x \in \DElta_i$, то $\xi$ прийняла значення $y_i$. \\

Генерування рівномірного розподілу на $[1, m]$: \\

$p_i = P \{ \xi = i \} = \dfrac{1}{m}$, $i = \overline{1,m}$. $x$ -- значення датчика $U([0,1))$, тоді $\xi$ набуває значення $\lfloor 1 + m x \rfloor$.

\section{Моделювання неперервних випадкових величин}

Необхідно моделювати неперервну випадкову величину $\xi$ із функцією розподілу $F(z)$. \\

Розглянемо випадок коли $F(z)$ -- строго монотонна функція. \\

Тоді у ролі реалізації $\xi$ може виступити $F^{-1}(x)$, де $x$ -- значення датчику $U([0,1))$, а $F^{-1}(x)$ -- обернена функція розподілу до $F(z)$. \\

Нехай $\eta$ -- випадкова величина, $F(\eta) = U([0, 1))$. Тоді $F^{-1}(\eta)$:
\[ P\{ F^{-1}(\eta) < x \} = P \{ \eta < F(x) \} = F(x) \]

\textbf{Приклад.} $\xi$ -- випадкова величина, що має показниковий закон розподілу з параметром $\lambda > 0$.

\end{document}
